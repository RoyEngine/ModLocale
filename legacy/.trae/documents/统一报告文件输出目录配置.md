## 问题分析

当前报告文件散落在不同的子目录中，主要原因是：

1. **save_report函数** 没有区分单个文件和多个文件的处理情况
2. **报告保存路径** 直接使用了传入的report_path，没有根据处理数量进行调整
3. **缺少统一管理机制** 没有为多个文件处理情况创建专门的Report文件夹

## 修复方案

修改 `src/common/report_utils.py` 中的 `save_report` 函数，添加对单个文件和多个文件处理情况的判断：

### 1. 修改save_report函数

```python
def save_report(report: Dict[str, Any], report_path: str, timestamp: str, rule_type: str = None, mod_name: str = None, language: str = None) -> bool:
    """
    保存报告到文件

    Args:
        report: 报告数据
        report_path: 报告保存路径
        timestamp: 时间戳
        rule_type: 规则类型(regular: 常规提取规则, mapping: 映射规则)
        mod_name: 模组名称
        language: 语言类型(English或Chinese)

    Returns:
        bool: 是否成功保存
    """
    try:
        # 根据规则类型确定基础报告保存路径
        base_report_path = report_path
        
        # 判断是单个文件还是多个文件处理
        is_single_file = False
        data = report.get("data", {})
        total_count = data.get("total_count", 1)
        
        # 检查total_count，判断是否为单个文件处理
        if total_count == 1:
            is_single_file = True
        
        # 检查是否为单个JAR文件反编译报告
        if report.get("sub_flow") == "反编译单个JAR文件":
            is_single_file = True
        
        # 确定最终报告保存路径
        if is_single_file:
            # 单个文件处理，直接保存到输出文件夹根目录
            final_report_path = base_report_path
        else:
            # 多个文件处理，统一保存到Report文件夹内
            final_report_path = os.path.join(base_report_path, "Report")
        
        # 确保报告目录存在
        os.makedirs(final_report_path, exist_ok=True)

        # 构建报告文件名
        report_file = os.path.join(
            final_report_path, f"{report['mode'].lower()}_{timestamp}_report.json"
        )

        # 保存报告
        with open(report_file, "w", encoding="utf-8") as f:
            json.dump(report, f, ensure_ascii=False, indent=2)

        print(f"[OK] 报告保存成功: {report_file}")
        return True
    except Exception as e:
        print(f"[ERROR] 报告保存失败: {e}")
        return False
```

### 2. 修改decompile_mode/core.py中的报告保存逻辑

由于decompile_mode在处理多个JAR文件时会为每个文件生成单独的报告，需要确保这些报告也遵循统一的保存规则：

```python
# 在save_report调用处添加处理逻辑
# 将所有报告保存到Report文件夹内
save_report(single_report, os.path.join(output_dir, "Report"), timestamp)
```

## 修复理由

1. **符合用户需求** 按照用户要求将报告文件分类保存
2. **提高可维护性** 统一管理多个文件处理的报告，便于查找和管理
3. **保持灵活性** 单个文件处理时报告仍保存到输出文件夹根目录，方便直接查看
4. **代码逻辑清晰** 明确区分单个文件和多个文件的处理情况

## 预期效果

1. 处理单个文件夹时，报告保存到输出文件夹根目录
2. 处理多个文件时，所有报告统一保存到Report文件夹内
3. 报告文件路径结构清晰，便于用户查找和使用

## 修复文件

- **src/common/report_utils.py** 修改save_report函数，添加单个文件/多个文件判断逻辑
- **src/decompile_mode/core.py** 调整报告保存路径，确保多个JAR文件的报告统一保存到Report文件夹内